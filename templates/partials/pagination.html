{% if pagination and pagination.total_pages > 1 %}
<nav class="pagination" aria-label="Пагинация">
  <ul class="pagination__list">
    {% set last = pagination.total_pages %}
    {% set current = pagination.current_page %}

    {# Prev #}
    <li class="pagination__item">
      {% if current > 1 %}
        {% set prev_page = current - 1 %}
        {% set prev_url = base_url if prev_page == 1 else (base_url + 'page-' ~ prev_page ~ '/') %}
        <a class="pagination__link" href="{{ prev_url }}" aria-label="Предыдущая страница" rel="prev">‹</a>
      {% else %}
        <span class="pagination__link is-disabled" aria-disabled="true" aria-label="Предыдущая страница">‹</span>
      {% endif %}
    </li>

    {# Если страниц немного — показываем все #}
    {% if last <= 7 %}
      {% for p in range(1, last + 1) %}
        {% set url = base_url + ('page-' ~ p ~ '/') if p > 1 else base_url %}
        <li class="pagination__item">
          {% if p == current %}
            <span class="pagination__link is-current" aria-current="page">{{ p }}</span>
          {% else %}
            <a class="pagination__link" href="{{ url }}">{{ p }}</a>
          {% endif %}
        </li>
      {% endfor %}
    {% else %}
      {# Всегда первая #}
      {% set url1 = base_url %}
      <li class="pagination__item">
        {% if current == 1 %}
          <span class="pagination__link is-current" aria-current="page">1</span>
        {% else %}
          <a class="pagination__link" href="{{ url1 }}">1</a>
        {% endif %}
      </li>

      {# Левая многоточие, если есть разрыв #}
      {% set start = [2, current - 2]|max %}
      {% set end = [last - 1, current + 2]|min %}
      {% if start > 2 %}
        <li class="pagination__item">
          <span class="pagination__ellipsis" aria-hidden="true">…</span>
        </li>
      {% endif %}

      {# Центральное окно #}
      {% for p in range(start, end + 1) %}
        {% set url = base_url + ('page-' ~ p ~ '/') if p > 1 else base_url %}
        <li class="pagination__item">
          {% if p == current %}
            <span class="pagination__link is-current" aria-current="page">{{ p }}</span>
          {% else %}
            <a class="pagination__link" href="{{ url }}">{{ p }}</a>
          {% endif %}
        </li>
      {% endfor %}

      {# Правая многоточие, если есть разрыв #}
      {% if end < last - 1 %}
        <li class="pagination__item">
          <span class="pagination__ellipsis" aria-hidden="true">…</span>
        </li>
      {% endif %}

      {# Всегда последняя #}
      {% if last > 1 %}
        {% set urllast = base_url + 'page-' ~ last ~ '/' %}
        <li class="pagination__item">
          {% if current == last %}
            <span class="pagination__link is-current" aria-current="page">{{ last }}</span>
          {% else %}
            <a class="pagination__link" href="{{ urllast }}">{{ last }}</a>
          {% endif %}
        </li>
      {% endif %}
    {% endif %}

    {# Next #}
    <li class="pagination__item">
      {% if current < last %}
        {% set next_page = current + 1 %}
        {% set next_url = base_url + 'page-' ~ next_page ~ '/' %}
        <a class="pagination__link" href="{{ next_url }}" aria-label="Следующая страница" rel="next">›</a>
      {% else %}
        <span class="pagination__link is-disabled" aria-disabled="true" aria-label="Следующая страница">›</span>
      {% endif %}
    </li>
  </ul>
</nav>
{% endif %}


